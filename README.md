# TableNet Experiment Code for Reproduction
Official code of  experiment in TableNet: A Large-Scale Table Dataset with LLM-Powered Autonomous Generation

## Training Qwen2-VL-2B
Traing and inferencing splits in conversation format can generated by running
```
python preprocess.py
```
Notably, you should set to proper path on your machine.
```
generation_dir = "PATH TO GENERATION DATA/"
opensource_dir = "PATH TO OPENDATA/"
crawl_dir = "PATH TO CRAWLED DATA/"
```
Then you can train Qwen2-VL-2B by running
```
python main.py
```
You can inference with trained model or simply download trained model at [Huggingface]()

## Inference with trained model and other baselines
To get 2B result, set finetuned model path correctly
```
finetuned_model_path = "PATH TO TRAINED MODEL"
```
and then run
```
python test_main.py
```
For baseline results, run
```
python api_inference.py
```
This code needs 3 api keys, DASHSCOPE for Qwen series, yunwu.ai for GPT and superbed for url generation. Superbed api key is provided for reproduction.

Since results for table 2 needs 2 spanning matrices and constructing multiple cost a lot human effort, we only provide inference code in file generate_structure.py.
Other parts will be available alongside agent code after acceptance.


